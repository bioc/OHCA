---
bibliography: bibliography.bib
---

# Representation of genomic data in R

```{r}
#| echo: false
source("_common.R")
```

::: {.callout-note}
## Aims
This notebook introduces the four main classes offered by `Bioconductor` which 
support Hi-C analysis, describes their structure and how to interact with them:  
- `GRanges`;  
- `GInteractions`;  
- `ContactFile`;  
- `HiCExperiment`  
:::

## `GRanges` class

`GRanges` is a shorthand for `GenomicRanges`, a core class in `Bioconductor`. 
The data structure has been published in the fundamental 2015 publication by `Bioconductor` (@Huber2015Feb). 

`GenomicRanges` objects aim to provide a natural description of genomic 
intervals and are incredibly versatile. 

## `GInteractions` class

## `ContactFile` class

Contact matrices can be in three different formats (see [previous chapter](principles.qmd#binned-contact-matrix-files)): 

- `.(m)cool` matrix (multi-scores, multi-resolution, indexed)
- `.hic` matrix (multi-scores, multi-resolution, indexed)
- HiC-pro derived matrix (single-score, single-resolution, non-indexed)

Example contact matrix files can be obtained using `HiContactsData` function. 

```{r}
library(HiContactsData)
coolf <- HiContactsData('yeast_wt', 'mcool')
hicf <- HiContactsData('yeast_wt', 'hic')
hicpromatrixf <- HiContactsData('yeast_wt', 'hicpro_matrix')
hicproregionsf <- HiContactsData('yeast_wt', 'hicpro_bed')
```

A connection to each of these files can then be created in R using the matching function. 

```{r}
library(HiCExperiment)
CoolFile(coolf)
HicFile(hicf)
HicproFile(hicpromatrixf, hicproregionsf)
```

## `HiCExperiment` class

```{r yeast_norm}
hic <- contacts_yeast(full = TRUE)
hic
```

## References {-}

::: {#refs}
:::
